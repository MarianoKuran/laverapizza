<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>La Vera Pizza | Men√∫</title>
        <!-- Tailwind CSS CDN -->
        <script src="https://cdn.tailwindcss.com"></script>
        <script src="https://kit.fontawesome.com/d821ae6b42.js" crossorigin="anonymous"></script>
        <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&family=Roboto:wght@400;500&display=swap" rel="stylesheet">
        <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 16 16%22><text y=%2214%22 font-size=%2216%22>üçï</text></svg>">
    </head>
    <body class="grid grid-cols-6 grid-rows-12 min-h-[100dvh] max-h-[100dvh] max-w-[100dvw]">
        <div class="grid grid-cols-6 row-span-1 col-span-6 bg-black">
            <a href="index.html" class="flex items-center justify-center col-span-1 text-gray-100">
                <i class="fa-solid fa-chevron-left"></i>
            </a>
            <a href="index.html" class="flex items-center col-start-2 col-end-6 text-gray-100">
                <div class="w-full flex justify-center items-end">
                    <!-- icons -->
                    <div class="relative w-fit mr-2">
                        <i class="pizza-hang fa-solid fa-pizza-slice fa-flip-horizontal text-4xl text-red-600"></i>
                        <i class="absolute fire-pulse animate-pulse fa-solid fa-fire text-[10px] top-0.5 left-8  text-orange-500"></i>
                    </div>
                    <h1 class="ps-2 text-2xl lg:text-3xl font-bold">La Vera Pizza</h1>
                </div>
            </a>
        </div>
        <div class="col-span-6 flex justify-center pt-5 text-gray-100 bg-black leading-none">
            <h2 class="text-xl font-bold">Nuestro <span class="bg-gradient-to-tr from-red-500 from-30% to-yellow-500 text-transparent bg-clip-text">Men√∫</span></h2>
        </div>

        <div id="menu-cards-ctn" class="grid gap-2 grid-cols-10 col-span-6 row-start-3 row-end-12 py-2 overflow-y-auto"></div>
        

        <div class="col-span-6 row-start-12 flex justify-center items-center gap-4 text-gray-100 bg-black">
            <button type="button" onclick="seeDetails()" class="py-2 px-8 text-gray-100/70 font-semibold rounded-lg bg-gray-200/10 border border-gray-200/30 hover:text-gray-100 hover:bg-gray-200/30 duration-300">Ver Detalle</button>
            <button type="button" onclick="sendOrder()" class="py-2 px-8 text-gray-100 font-semibold rounded-lg bg-gradient-to-tr from-red-500 from-30% to-yellow-600 shadow-md shadow-orange-800/60 hover:shadow-lg hover:shadow-orange-800/50 duration-300">Pedir</button>
        </div>


        <div id="details-modal" class="hidden absolute max-h-[100dvh] h-fit bottom-[70px] w-full text-gray-100 bg-black/90">
            <div class="flex justify-between items-center">
                <h3 class="mt-2 ms-6 font-semibold uppercase"><i class="fa-solid fa-cart-shopping me-2"></i>Detalles</h3>
                <button type="button" onclick="hideDetails()" class="flex justify-center border mt-3 me-3 p-2 rounded">
                    <i class="fa-solid fa-times"></i>
                </button>
            </div>
            <div id="details-ctn" class="px-6 max-h-[150px] overflow-auto"></div>
        </div>

        <script>
            const menuCardsCtn = document.getElementById('menu-cards-ctn');
            var products = [
                {name:'Margarita', description:'', number:0},
                {name:'Bolognesa', description:'', number:0},
                {name:'Pepperonni', description:'', number:0},
                {name:'4 quesos', description:'', number:0},
                {name:'Choclo', description:'', number:0},
                {name:'Especial', description:'', number:0},
                {name:'Rucula', description:'', number:0},
            ];

            function seeDetails() {
                const hasAnyProduct = products.some(product => product.number > 0);
                if (hasAnyProduct) {
                    let detailsCtn = document.getElementById('details-ctn');
                    
                    detailsCtn.innerHTML = '';
                    products.forEach((product, productIndex) => {
                        if (product.number > 0) {
                            let cardHtml = `<div class="text-gray-300 italic"><span class="font-semibold">${product.name}</span> x${product.number}</div>`;
                            detailsCtn.innerHTML += cardHtml;
                        }
                    });
                    
                    document.getElementById('details-modal').classList.remove('hidden');
                }
            }

            function hideDetails() {
                document.getElementById('details-ctn').innerHTML = '';
                document.getElementById('details-modal').classList.add('hidden');
            }

            function addProduct(productIndex) {
                hideDetails();
                products[productIndex].number++
                renderMenu();
            }
            
            function removeProduct(productIndex) {
                hideDetails();
                if (products[productIndex].number > 0) {
                    products[productIndex].number--
                    renderMenu();
                }
            }

            function renderMenu() {
                menuCardsCtn.innerHTML = '';
                products.forEach((product, productIndex) => {
                    let cardHtml = `<div class="col-start-2 col-end-10 flex flex-col justify-between px-4 py-2 leading-none rounded-lg border">
                                        <h3 class="font-semibold mb-1">${product.name}</h3>
                                        <p class="text-gray-300/90 truncate">${product.description}</p>
                                        <div class="flex items-center justify-end mt-4">
                                            <button type="button" onclick="removeProduct(${productIndex})" class="border p-2 rounded-lg text-xs"><i class="fa-solid fa-minus"></i></button>
                                            <input type="number" min="0" step="1" max="20" disabled data-product-index="0" class="product-number-input mx-2 py-1 text-center rounded-lg border" value="${product.number}">
                                            <button type="button" onclick="addProduct(${productIndex})" class="border p-2 rounded-lg text-xs"><i class="fa-solid fa-plus"></i></button>
                                        </div>
                                    </div>`;
                    menuCardsCtn.innerHTML += cardHtml;
                });
            }
            
            renderMenu();

            var phone = "543856776615";
            function sendOrder() {
                const hasAnyProduct = products.some(product => product.number > 0);

                if (hasAnyProduct) {
                    let message = `üçï *NUEVO PEDIDO*`;
                    products.forEach(product => {
                        if (product.number > 0) {
                            message += `\n_*${product.name}* x${product.number}_`;
                        }
                    });
    
                    // Limpieza de posibles caracteres ocultos
                    message = message.replace(/^\uFEFF/, '').trim();
    
                    const encoded = encodeURIComponent(message);
    
                    // URLs para cada entorno
                    const wa_me = `https://wa.me/${phone}?text=${encoded}`;
                    const web = `https://web.whatsapp.com/send?phone=${phone}&text=${encoded}`;
                    const app = `whatsapp://send?phone=${phone}&text=${encoded}`;
    
                    // Detectar si es mobile o desktop
                    const isMobile = /Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
    
                    if (isMobile) {
                        try {
                            window.open(app, "_blank");
                        } catch (e) {
                            window.open(wa_me, "_blank");
                        }
                    } else {
                        window.open(web, "_blank");
                    }
                } else {
                    window.alert('No hay productos seleccionados para pedir.')
                }
            }
        </script>
    </body>
</html>
